<div class="module">
	<div class="container-fluid">
		<div class="module-heading">
			List report
			<div class="pull-right">
				<button type="button" class="btn btn-sm btn-success" (click)="save(false)">Save</button>
				<button type="button" class="btn btn-sm btn-warning" (click)="save(true)">Save & Close</button>
				<button type="button" class="btn btn-sm btn-danger" (click)="close()">Cancel</button>
			</div>
		</div>
		<div class="module-body">
			<form>
				<div class="row">
					<div class="form-group col-md-6">
						<label for="name">Name</label>
						<input type="text" class="form-control" id="name" [(ngModel)]="libraryItem.name" name="name">
					</div>
				</div>
				<div class="row">
					<div class="form-group col-md-12">
						<label for="description">Description</label>
						<textarea class="form-control" id="description" [(ngModel)]="libraryItem.description" name="description"></textarea>
					</div>
				</div>
				<div class="row">
					<div class="form-group col-md-8">
						<label>List groups</label>
						<button type="button" class="btn btn-xs btn-success" (click)="addListGroup()">
							<span class="fa fa-plus"></span>
						</button>
						<div class="table scroll-box-450 form-control">
							<table class="table table-striped table-condensed">
								<thead>
									<tr>
										<th class="col-md-4">Heading</th>
										<th class="col-md-2">Type</th>
										<th class="col-md-4">Details</th>
										<th class="col-md-2"></th>
									</tr>
								</thead>
								<tbody>
									<tr class="hover-box show-child-on-hover"
											*ngFor="let item of getListReportGroupItems()"
											(click)="selectedListReportGroup = item; loadDataSourceAvailableFieldList()"
											[ngClass]="{'selection': item == selectedListReportGroup}">
										<td>{{item.heading}}</td>
										<td><span class="fa fa-right-pad {{ item | listReportGroupToIcon }} text-muted"></span>{{ item | listReportGroupToTypeName }}</td>
										<td>{{ item | listReportGroupToDescription }}</td>
										<td>
											<div class="child-to-show">
												<button type="button" class="btn btn-danger btn-xs pull-right" (click)="removeListGroup(this)">
													<span class="fa fa-remove"></span>
												</button>
											</div>
										</td>
									</tr>
								</tbody>
							</table>
						</div>
					</div>
					<div class="form-group col-md-4" *ngIf="selectedListReportGroup">
						<div class="row" *ngIf="selectedListReportGroup.fieldBased">
							<div class="form-group col-md-12">
								<label for="fieldBased-dataSource">Data source</label>
								<div class="input-group">
									<input type="text"
												 class="form-control"
												 id="fieldBased-dataSource"
												 value="{{getDatasourceDisplayName()}}" disabled>
									<span class="input-group-addon" (click)="selectDataSource(selectedListReportGroup.fieldBased)" style="cursor: pointer">
										<i class="fa fa-database" id="fieldBased-dataSource" aria-hidden="true"></i>
									</span>
								</div>
							</div>
						</div>
						<div class="row">
							<div class="form-group col-md-12">
								<label for="group-heading">Heading</label>
								<input type="text" class="form-control" id="group-heading" [(ngModel)]="selectedListReportGroup.heading" name="heading">
							</div>
						</div>
						<div class="row" *ngIf="selectedListReportGroup.fieldBased.dataSource">
							<div class="form-group col-md-12">
								<label for="fieldBased-dataSource">Field output</label>
								<button type="button" class="btn btn-xs btn-success" (click)="addFieldOutput()">
									<span class="fa fa-plus"></span>
								</button>
								<div class="table scroll-box-300 form-control">
									<table class="table table-striped">
										<thead>
											<th class="col-md-5">Field</th>
											<th class="col-md-4">Heading</th>
											<th class="col-md-3"></th>
										</thead>
										<tbody>
											<tr class="hover-box show-child-on-hover"
													*ngFor="let item of selectedListReportGroup.fieldBased.fieldOutput">
												<td>
													<span class="child-to-hide">{{ getFieldDisplayName(item.field) }}</span>
													<div class="btn-group child-to-show" role="group" ngbDropdown>
														<button type="button" class="btn btn-sm btn-default dropdown-toggle" ngbDropdownToggle id="fieldMenu">
															{{ getFieldDisplayName(item.field) }}
															<span class="caret"></span>
														</button>
														<ul class="dropdown-menu" aria-labelledby="fieldMenu">
															<li *ngFor="let field of dataSourceAvailableFields"><a (click)="setItemField(item, field)">{{ field.displayName }}</a></li>
														</ul>
													</div>
												</td>
												<td>
													<span class="child-to-hide">{{ item.heading }}</span>
													<input type="text" class="form-control input-sm child-to-show" [(ngModel)]="item.heading" name="itemHeading">
												</td>
												<td>
													<div class="pull-right">
														<button type="button" class="btn btn-danger btn-xs child-to-show" (click)="removeFieldOutput(this)">
															<span class="fa fa-remove"></span>
														</button>
													</div>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>
					</div>
				</div>
			</form>
		</div>
	</div>
</div>
