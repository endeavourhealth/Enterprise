<?xml version="1.0" encoding="UTF-8"?>
<discoveryDefinition xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="..\src\enterprise-core\src\main\resources\EnterpriseDocument.xsd">
	<folder>
		<uuid>9A042C35-6F2A-4400-9417-54F668EDED11</uuid>
		<name>Sample documents</name>
	</folder>
	<libraryItem>
		<uuid>6C138CB7-7C8A-470E-9D2C-28A1E269748D</uuid>
		<name>Palliative Care Codes</name>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<codeSet>
			<codingSystem>EMISReadV2</codingSystem>
			<codeSetValue>
				<code>8BA2</code>
				<includeChildren>false</includeChildren>
			</codeSetValue>
			<codeSetValue>
				<code>8CM1</code>
				<includeChildren>true</includeChildren>
				<exclusion>
					<code>8CM15</code>
					<includeChildren>true</includeChildren>
				</exclusion>
			</codeSetValue>
		</codeSet>
	</libraryItem>
	<libraryItem>
		<uuid>4E319A39-C101-425F-94ED-AFB112CD5DC5</uuid>
		<name>PC001 (Inline) - Code and date</name>
		<description>Palliative care code after 2008</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<rule>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>8BA2</code>
									<includeChildren>false</includeChildren>
								</codeSetValue>
								<codeSetValue>
									<code>8CM1</code>
									<includeChildren>true</includeChildren>
									<exclusion>
										<code>8CM15</code>
										<includeChildren>true</includeChildren>
									</exclusion>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
						<filter>
							<field>EFFECTIVE_DATE</field>
							<valueFrom>
								<constant>2008-04-01</constant>
								<absoluteUnit>date</absoluteUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>6E190380-8058-4D4B-B266-95E871AD00C7</uuid>
		<name>PC001 (Reference) - Code and date</name>
		<description>Palliative care code after 2008 but using library reference</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<rule>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSetLibraryItemUuid>6C138CB7-7C8A-470E-9D2C-28A1E269748D</codeSetLibraryItemUuid>
							<negate>false</negate>
						</filter>
						<filter>
							<field>EFFECTIVE_DATE</field>
							<valueFrom>
								<constant>2008-04-01</constant>
								<absoluteUnit>date</absoluteUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>6CAC8D34-0E9A-4863-B72D-0394D82E96CA</uuid>
		<name>HYP001 - Field test</name>
		<description>Patient has hypotension without a hypotension resolved code following it</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<rule>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>21261</code>
									<includeChildren>false</includeChildren>
								</codeSetValue>
							</codeSet>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>G2</code>
									<includeChildren>false</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
						<restriction>
							<fieldName>EFFECTIVE_DATE</fieldName>
							<orderDirection>descending</orderDirection>
							<count>1</count>
						</restriction>
					</dataSource>
					<fieldTest>
						<field>CODE</field>
						<codeSet>
							<codingSystem>EMISReadV2</codingSystem>
							<codeSetValue>
								<code>G2</code>
								<includeChildren>false</includeChildren>
							</codeSetValue>
						</codeSet>
						<negate>false</negate>
					</fieldTest>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>0D738BDA-FD41-48D7-ACD9-8722A74B4A30</uuid>
		<name>HF001 - Two tests</name>
		<description>Patient has a heart failure code and an LVSD code</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<rule>
				<operator>and</operator>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>G58</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>G5yy9</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>5606102C-6C4D-41BD-8D50-7057959754A7</uuid>
		<name>[HF002] - More complex boolean logic</name>
		<description>
			If HF code after 2006 then move to next rule, else exclude.
			If echocardiogram OR no echocardiogram declined, then include, else next rule.
			If registration date is within 3 months then include, else exclude
		</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<parentQueryUuid>0D738BDA-FD41-48D7-ACD9-8722A74B4A30</parentQueryUuid>
			<rule>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>G58</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
						<filter>
							<field>EFFECTIVE_DATE</field>
							<valueFrom>
								<constant>2006-04-01</constant>
								<absoluteUnit>date</absoluteUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>nextRule</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
			<rule>
				<operator>or</operator>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>5853</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>ECEXC_COD</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>true</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>nextRule</onFalse>
			</rule>
			<rule>
				<test>
					<dataSource>
						<entity>PATIENT</entity>
						<filter>
							<field>REGISTRATION_DATE</field>
							<valueFrom>
								<constant>-3</constant>
								<relativeUnit>month</relativeUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>BDD77D78-EC30-4B02-9650-EB0710B5CF75</uuid>
		<name>AST001 (Simplified) - Drugs codes with relative dates</name>
		<description>Asthma medication prescribed within 12 months of the baseline date</description>
		<folderUuid>9A042C35-6F2A-4400-9417-54F668EDED11</folderUuid>
		<query>
			<rule>
				<test>
					<dataSource>
						<entity>MEDICATION_ISSUE</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>DMD</codingSystem>
								<codeSetValue>
									<code>320176004</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
						<filter>
							<field>EFFECTIVE_DATE</field>
							<valueFrom>
								<constant>-12</constant>
								<relativeUnit>month</relativeUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
							<negate>false</negate>
						</filter>
					</dataSource>
					<isAny/>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
	<libraryItem>
		<uuid>82CBFF61-D9C0-4163-83D5-D5835088C137</uuid>
		<name>AST002 (Simplified) - Linked criteria</name>
		<description>Asthma codes with a spirometry test within 3 months</description>
		<folderUuid>BDD77D78-EC30-4B02-9650-EB0710B5CF75</folderUuid>
		<query>
			<parentQueryUuid/>
			<rule>
				<test>
					<dataSource>
						<entity>OBSERVATION</entity>
						<filter>
							<field>CODE</field>
							<codeSet>
								<codingSystem>EMISReadV2</codingSystem>
								<codeSetValue>
									<code>H33</code>
									<includeChildren>true</includeChildren>
								</codeSetValue>
							</codeSet>
							<negate>false</negate>
						</filter>
						<restriction>
							<fieldName>EFFECTIVE_DATE</fieldName>
							<orderDirection>descending</orderDirection>
							<count>1</count>
						</restriction>
					</dataSource>
					<isAny/>
					<linkedTest>
						<dataSource>
							<entity>OBSERVATION</entity>
							<filter>
								<field>CODE</field>
								<codeSet>
									<codingSystem>EMISReadV2</codingSystem>
									<codeSetValue>
										<code>33G1</code>
										<includeChildren>true</includeChildren>
									</codeSetValue>
								</codeSet>
								<negate>false</negate>
							</filter>
						</dataSource>
						<parentField>EFFECTIVE_DATE</parentField>
						<childField>EFFECTIVE_DATE</childField>
						<comparison>
							<valueFrom>
								<constant>-3</constant>
								<relativeUnit>month</relativeUnit>
								<operator>greaterThanOrEqualTo</operator>
							</valueFrom>
						</comparison>
					</linkedTest>
				</test>
				<onTrue>include</onTrue>
				<onFalse>exclude</onFalse>
			</rule>
		</query>
	</libraryItem>
</discoveryDefinition>
